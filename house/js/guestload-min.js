function updateTips(e){"use strict";tips.text(e).addClass("ui-state-highlight")}function errorOnZero(e,t){"use strict";return""==e.val()||"0"==e.val()||"00"==e.val()?(e.addClass("ui-state-error"),updateTips(t+" cannot be zero"),!1):!0}function checkLength(e,t,a,i){"use strict";return e.val().length>i||e.val().length<a?(e.addClass("ui-state-error"),updateTips(0==e.val().length?"Fill in the "+t:a==i?"The "+t+" must be "+i+" characters.":e.val().length>i?"The "+t+" length is to long":"The "+t+" length must be between "+a+" and "+i+"."),!1):!0}function isNumber(e){"use strict";return!isNaN(parseFloat(e))&&isFinite(e)}function updateVisitMessage(e,t,a){$("#"+a+"h3VisitMsgHdr").text(e),$("#"+a+"spnVisitMsg").text(t),$("#"+a+"visitMsg").effect("pulsate")}function relationReturn(e){if(e=$.parseJSON(e),e.error)e.gotopage&&window.open(e.gotopage,"_self"),flagAlertMessage(e.error,!0);else if(e.success){if(e.rc&&e.markup){var t=$("#acm"+e.rc);t.children().remove();var a=$(e.markup);t.append(a.children())}flagAlertMessage(e.success,!1)}}function manageRelation(e,t,a,i){$.post("ws_admin.php",{id:e,rId:t,rc:a,cmd:i},relationReturn)}function sendVoidReturn(e,t,a,i){var r={pid:a,bid:e};t&&"v"===t?r.cmd="void":t&&"rv"===t?r.cmd="revpmt":t&&"r"===t?(r.cmd="rtn",r.amt=i):t&&"vr"===t&&(r.cmd="voidret"),$.post("ws_ckin.php",r,function(e){var t="";if(e){try{e=$.parseJSON(e)}catch(a){return void alert("Parser error - "+a.message)}if(e.bid&&$("#"+e.bid).remove(),e.error)return e.gotopage&&window.location.assign(e.gotopage),void flagAlertMessage(e.error,!0);if(e.reversal&&""!==e.reversal&&(t=e.reversal),e.warning)return void flagAlertMessage(t+e.warning,!0);e.success&&flagAlertMessage(t+e.success,!1),e.receipt&&showReceipt("#pmtRcpt",e.receipt,"Receipt")}})}function cardOnFile(e,t,a){var i={cmd:"cof",idGuest:e,idGrp:t,pbp:"GuestEdit.php?id="+e+"&psg="+a};$("#tblupCredit").find("input").each(function(){this.checked&&(i[$(this).attr("id")]=$(this).val())}),$.post("ws_ckin.php",i,function(e){if(e){try{e=$.parseJSON(e)}catch(t){return void alert("Parser error - "+t.message)}if(e.error)return e.gotopage&&window.open(e.gotopage,"_self"),void flagAlertMessage(e.error,!0);if(e.hostedError&&flagAlertMessage(e.hostedError,!0),e.xfer){var a=$("#xform");a.prop("action",e.xfer),$("#CardID").val(e.cardId),a.submit()}e.success&&flagAlertMessage(e.success,!1)}})}var dtCols=[{aTargets:[0],sTitle:"Date",sType:"date",mDataProp:function(e,t,a){"use strict";if("set"===t)return e.LogDate=a,null;if("display"===t){if(void 0===e.Date_display){var i=new Date(Date.parse(e.LogDate));e.Date_display=i.getMonth()+1+"/"+i.getDate()+"/"+i.getFullYear()+" "+i.getHours()+":"+i.getMinutes()}return e.Date_display}return e.LogDate}},{aTargets:[1],sTitle:"Type",bSearchable:!1,bSortable:!1,mDataProp:"LogType"},{aTargets:[2],sTitle:"Sub-Type",bSearchable:!1,bSortable:!1,mDataProp:"Subtype"},{aTargets:[3],sTitle:"User",bSearchable:!1,bSortable:!1,mDataProp:"User"},{aTargets:[4],bVisible:!1,mDataProp:"idName"},{aTargets:[5],sTitle:"Log Text",bSortable:!1,mDataProp:"LogText"}];$(document).ready(function(){"use strict";var e=!1,t=1;$(window).bind("beforeunload",function(){if(e!==!0){var t=!1;if($("#form1").find("input[type='text'],textarea").not(".ignrSave").each(function(){if(this.value!=this.defaultValue&&0===$(this).parents("div.ignrSave").length){this.value;return t=!0,!1}}),$("#form1").find("input[type='radio'],input[type='checkbox']").not(".ignrSave").each(function(){if($(this).prop("checked")!==$(this).prop("defaultChecked")&&0===$(this).parents("div.ignrSave").length){$(this).prop("checked");return t=!0,!1}}),$("#form1").find("select").not(".ignrSave").each(function(){if($(this).data("bfhstates")){if($(this).data("state")!==$(this).val())return t=!0,!1}else if($(this).data("bfhcountries")){if($(this).data("country")!==$(this).val())return t=!0,!1}else $(this).children("option").each(function(){if(this.defaultSelected!==this.selected){this.selected;return t=!0,!1}})}),t===!0)return!1}}),$.ajaxSetup({beforeSend:function(){$("body").css("cursor","wait")},complete:function(){$("body").css("cursor","auto")},cache:!1}),$("#contentDiv").css("margin-top",$("#global-nav").css("height"));var a;if($("#divFuncTabs").tabs({collapsible:!0}),$("#submit").dialog({autoOpen:!1,resizable:!1,width:300,modal:!0,buttons:{Exit:function(){$(this).dialog("close")}}}),$("#keysfees").dialog({autoOpen:!1,resizable:!0,modal:!0,close:function(e,t){$("div#submitButtons").show()},open:function(e,t){$("div#submitButtons").hide()}}),$("#pmtRcpt").dialog({autoOpen:!1,resizable:!0,modal:!0,title:"Payment Receipt"}),$("#faDialog").dialog({autoOpen:!1,resizable:!0,width:650,modal:!0,title:"Income Chooser"}),""!==rctMkup&&showReceipt("#pmtRcpt",rctMkup),$(".hhk-view-visit").click(function(){var e=$(this).data("vid"),t=$(this).data("gid"),a=$(this).data("span"),i={"Show Statement":function(){window.open("ShowStatement.php?vid="+e,"_blank")},"Show Registration Form":function(){window.open("ShowRegForm.php?vid="+e,"_blank")},Save:function(){saveFees(t,e,a,!1,"GuestEdit.php?id="+t+"&psg="+memData.idPsg)},Cancel:function(){$(this).dialog("close")}};viewVisit(t,e,i,"Edit Visit #"+e+"-"+a,"",a),$("#divAlert1").hide()}),$("#resvAccordion").accordion({heightStyle:"content",collapsible:!0,active:!1,icons:!1}),$("div.hhk-relations").each(function(){var e=$(this).attr("name");$(this).on("click","td.hhk-deletelink",function(){memData.id>0&&confirm($(this).attr("title")+"?")&&manageRelation(memData.id,$(this).attr("name"),e,"delRel")}),$(this).on("click","td.hhk-newlink",function(){if(memData.id>0){var t=$(this).attr("title");$("#hdnRelCode").val(e),$("#submit").dialog("option","title",t),$("#submit").dialog("open")}})}),$("#cbNoVehicle").change(function(){this.checked?$("#tblVehicle").hide():$("#tblVehicle").show()}),$("#cbNoVehicle").change(),$("#btnNextVeh, #exAll, #exNone").button(),$("#btnNextVeh").click(function(){$("#trVeh"+t).show("fade"),t++,t>4&&$("#btnNextVeh").hide("fade")}),$("#schLogText").keyup(function(){this.value.length>2&&a&&a.fnFilter(this.value,5)}),$("#divNametabs").tabs({beforeActivate:function(e,t){var a=$("#vvisitLog").find("table");3==t.newTab.index()&&0==a.length&&$.post("ws_ckin.php",{cmd:"gtvlog",idReg:memData.idReg},function(e){if(e){try{e=$.parseJSON(e)}catch(t){return void alert("Parser error - "+t.message)}e.error?(e.gotopage&&window.open(e.gotopage,"_self"),flagAlertMessage(e.error,!0)):e.vlog&&$("#vvisitLog").append($(e.vlog))}})},collapsible:!0}),$("#btnSubmit, #btnReset, #btnCred").button(),$("#btnCred").click(function(){cardOnFile($(this).data("id"),$(this).data("idreg"),memData.idPsg)}),$("#phEmlTabs").tabs(),$("#emergTabs").tabs(),$("#addrsTabs").tabs(),$("#psgList").tabs({collapsible:!0,beforeActivate:function(e,t){t.newPanel.length>0&&"#vfin"===t.newPanel.selector&&(getIncomeDiag(0,memData.idReg),e.preventDefault())}}),memData.psgOnly&&$("#psgList").tabs("disable"),$("#psgList").tabs("enable",psgTabIndex),$("#psgList").tabs("option","active",psgTabIndex),$("#cbnoReturn").change(function(){this.checked?$("#selnoReturn").show():$("#selnoReturn").hide()}),$("#cbnoReturn").change(),0===memData.id)$("#divFuncTabs").tabs("option","disabled",[2,3,4]),$("#phEmlTabs").tabs("option","active",1),$("#phEmlTabs").tabs("option","disabled",[0]);else{var i=parseInt($("#addrsTabs").children("ul").data("actidx"),10);isNaN(i)&&(i=0),$("#addrsTabs").tabs("option","active",i)}$.datepicker.setDefaults({yearRange:"-0:+02",changeMonth:!0,changeYear:!0,autoSize:!0,numberOfMonths:1,dateFormat:"M d, yy"}),$(".ckdate").datepicker({yearRange:"-02:+03"}),$(".ckbdate").datepicker({yearRange:"-99:+00",changeMonth:!0,changeYear:!0,autoSize:!0,maxDate:0,dateFormat:"M d, yy"}),$("#cbLastConfirmed").change(function(){$(this).prop("checked")?$("#txtLastConfirmed").datepicker("setDate","+0"):$("#txtLastConfirmed").val($("#txtLastConfirmed").prop("defaultValue"))}),$("#txtLastConfirmed").change(function(){$("#txtLastConfirmed").val()==$("#txtLastConfirmed").prop("defaultValue")?$("#cbLastConfirmed").prop("checked",!1):$("#cbLastConfirmed").prop("checked",!0)}),verifyAddrs("div#nameTab, div#hospitalSection"),addrPrefs(memData);var r;createZipAutoComplete($("input.hhk-zipsearch"),"ws_admin.php",r),$("#btnSubmit").click(function(){return"Saving>>>>"==$(this).val()?!1:(e=!0,void $(this).val("Saving>>>>"))}),$("#txtsearch").keypress(function(e){var t=$(this).val();"13"==e.keyCode&&(""!=t&&isNumber(parseInt(t,10))?window.location.assign("GuestEdit.php?id="+t):(alert("Don't press the return key unless you enter an Id."),e.preventDefault()))}),$("#cbdeceased").change(function(){$(this).prop("checked")?$("#disp_deceased").show():$("#disp_deceased").hide()}),$("select.hhk-multisel").each(function(){$(this).multiselect({selectedList:3})});var s;createAutoComplete($("#txtAgentSch"),3,{cmd:"filter",add:"phone",basis:"ra"},getAgent,s),""===$("#a_txtLastName").val()&&$(".hhk-agentInfo").hide(),createAutoComplete($("#txtDocSch"),3,{cmd:"filter",basis:"doc"},getDoc,s),""===$("#d_txtLastName").val()&&$(".hhk-docInfo").hide();var n,o;$("#txtsearch").autocomplete({source:function(e,t){if(isNumber(parseInt(e.term,10)))return void t();if(e.term.search(" ")==e.term.length-1||e.term.search(",")==e.term.length-1)t(o);else{var a={cmd:"role",mode:"mo",letters:e.term};n=$.getJSON("roleSearch.php",a,function(e,a,i){i===n&&(e.error&&(e.gotopage&&window.open(e.gotopage,"_self"),e.value=e.error),t(e),o=e)})}},minLength:3,select:function(e,t){if(t.item){var a=t.item.id;0!==a&&window.location.assign("GuestEdit.php?id="+a)}}}),$("#txtPhsearch").autocomplete({source:function(e,t){var a={cmd:"role",mode:"mo",letters:e.term};n=$.getJSON("roleSearch.php",a,function(e,a,i){i===n&&(e.error&&(e.gotopage&&window.open(e.gotopage,"_self"),e.value=e.error),t(e))})},minLength:5,select:function(e,t){if(t.item){var a=t.item.id;0!==a&&window.location.assign("GuestEdit.php?id="+a)}}}),$("#txtRelSch").autocomplete({source:function(e,t){if(e.term.search(" ")==e.term.length-1||e.term.search(",")==e.term.length-1)t(o);else{var a={cmd:"srrel",letters:e.term,basis:$("#hdnRelCode").val(),id:memData.id,nonly:"1"};n=$.getJSON("roleSearch.php",a,function(e,a,i){i===n?(e.error&&(e.gotopage&&window.open(e.gotopage,"_self"),e.value=e.error),t(e),o=e):t()})}},minLength:3,select:function(e,t){if(t.item){$("#submit").dialog("close");var a=parseInt(t.item.id,10);isNumber(a)&&$.post("ws_admin.php",{rId:a,id:memData.id,rc:$("#hdnRelCode").val(),cmd:"newRel"},relationReturn)}}}),$("input.hhk-check-button").click(function(){"exAll"==$(this).prop("id")?$("input.hhk-ex").prop("checked",!0):$("input.hhk-ex").prop("checked",!1)}),$(".hhk-hideStatus, .hhk-hideBasis").hide(),$("#divFuncTabs").show(),$(".hhk-showonload").show(),$("#txtsearch").focus()});
