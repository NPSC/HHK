function updateTips(a){"use strict";tips.text(a).addClass("ui-state-highlight")}function errorOnZero(a,b){"use strict";return""!=a.val()&&"0"!=a.val()&&"00"!=a.val()||(a.addClass("ui-state-error"),updateTips(b+" cannot be zero"),!1)}function checkLength(a,b,c,d){"use strict";return!(a.val().length>d||a.val().length<c)||(a.addClass("ui-state-error"),updateTips(0==a.val().length?"Fill in the "+b:c==d?"The "+b+" must be "+d+" characters.":a.val().length>d?"The "+b+" length is to long":"The "+b+" length must be between "+c+" and "+d+"."),!1)}function isNumber(a){"use strict";return!isNaN(parseFloat(a))&&isFinite(a)}function updateVisitMessage(a,b,c){$("#"+c+"h3VisitMsgHdr").text(a),$("#"+c+"spnVisitMsg").text(b),$("#"+c+"visitMsg").effect("pulsate")}function relationReturn(a){if(a=$.parseJSON(a),a.error)a.gotopage&&window.open(a.gotopage,"_self"),flagAlertMessage(a.error,!0);else if(a.success){if(a.rc&&a.markup){var b=$("#acm"+a.rc);b.children().remove();var c=$(a.markup);b.append(c.children())}flagAlertMessage(a.success,!1)}}function manageRelation(a,b,c,d){$.post("ws_admin.php",{id:a,rId:b,rc:c,cmd:d},relationReturn)}function sendVoidReturn(a,b,c,d){var e={pid:c,bid:a};b&&"v"===b?e.cmd="void":b&&"rv"===b?e.cmd="revpmt":b&&"r"===b?(e.cmd="rtn",e.amt=d):b&&"vr"===b&&(e.cmd="voidret"),$.post("ws_ckin.php",e,function(a){var b="";if(a){try{a=$.parseJSON(a)}catch(a){return void alert("Parser error - "+a.message)}if(a.bid&&$("#"+a.bid).remove(),a.error)return a.gotopage&&window.location.assign(a.gotopage),void flagAlertMessage(a.error,!0);if(a.reversal&&""!==a.reversal&&(b=a.reversal),a.warning)return void flagAlertMessage(b+a.warning,!0);a.success&&flagAlertMessage(b+a.success,!1),a.receipt&&showReceipt("#pmtRcpt",a.receipt,"Receipt")}})}function cardOnFile(a,b,c){var d={cmd:"cof",idGuest:a,idGrp:b,pbp:"GuestEdit.php?id="+a+"&psg="+c};$("#tblupCredit").find("input").each(function(){this.checked&&(d[$(this).attr("id")]=$(this).val())}),$.post("ws_ckin.php",d,function(a){if(a){try{a=$.parseJSON(a)}catch(a){return void alert("Parser error - "+a.message)}if(a.error)return a.gotopage&&window.open(a.gotopage,"_self"),void flagAlertMessage(a.error,!0);if(a.hostedError&&flagAlertMessage(a.hostedError,!0),a.xfer){var b=$("#xform");b.prop("action",a.xfer),$("#CardID").val(a.cardId),b.submit()}a.success&&flagAlertMessage(a.success,!1)}})}var dtCols=[{aTargets:[0],sTitle:"Date",sType:"date",mDataProp:function(a,b,c){"use strict";if("set"===b)return a.LogDate=c,null;if("display"===b){if(void 0===a.Date_display){var d=new Date(Date.parse(a.LogDate));a.Date_display=d.getMonth()+1+"/"+d.getDate()+"/"+d.getFullYear()+" "+d.getHours()+":"+d.getMinutes()}return a.Date_display}return a.LogDate}},{aTargets:[1],sTitle:"Type",bSearchable:!1,bSortable:!1,mDataProp:"LogType"},{aTargets:[2],sTitle:"Sub-Type",bSearchable:!1,bSortable:!1,mDataProp:"Subtype"},{aTargets:[3],sTitle:"User",bSearchable:!1,bSortable:!1,mDataProp:"User"},{aTargets:[4],bVisible:!1,mDataProp:"idName"},{aTargets:[5],sTitle:"Log Text",bSortable:!1,mDataProp:"LogText"}];$(document).ready(function(){"use strict";var a=!1,b=1;$(window).bind("beforeunload",function(){if(a!==!0){var b=!1;if($("#form1").find("input[type='text'],textarea").not(".ignrSave").each(function(){if(this.value!=this.defaultValue&&0===$(this).parents("div.ignrSave").length){this.value;return b=!0,!1}}),$("#form1").find("input[type='radio'],input[type='checkbox']").not(".ignrSave").each(function(){if($(this).prop("checked")!==$(this).prop("defaultChecked")&&0===$(this).parents("div.ignrSave").length){$(this).prop("checked");return b=!0,!1}}),$("#form1").find("select").not(".ignrSave").each(function(){if($(this).data("bfhstates")){if($(this).data("state")!==$(this).val())return b=!0,!1}else if($(this).data("bfhcountries")){if($(this).data("country")!==$(this).val())return b=!0,!1}else $(this).children("option").each(function(){if(void 0!==this.defaultSelected&&void 0!==this.selected&&this.defaultSelected!==this.selected){this.selected;b=!0}})}),b===!0)return!1}}),$.ajaxSetup({beforeSend:function(){$("body").css("cursor","wait")},complete:function(){$("body").css("cursor","auto")},cache:!1}),$("#contentDiv").css("margin-top",$("#global-nav").css("height"));var c;if($("#divFuncTabs").tabs({collapsible:!0}),$("#submit").dialog({autoOpen:!1,resizable:!1,width:300,modal:!0,buttons:{Exit:function(){$(this).dialog("close")}}}),$("#keysfees").dialog({autoOpen:!1,resizable:!0,modal:!0,close:function(a,b){$("div#submitButtons").show()},open:function(a,b){$("div#submitButtons").hide()}}),$("#pmtRcpt").dialog({autoOpen:!1,resizable:!0,modal:!0,title:"Payment Receipt"}),$("#faDialog").dialog({autoOpen:!1,resizable:!0,width:650,modal:!0,title:"Income Chooser"}),""!==rctMkup&&showReceipt("#pmtRcpt",rctMkup),$(".hhk-view-visit").click(function(){var a=$(this).data("vid"),b=$(this).data("gid"),c=$(this).data("span"),d={"Show Statement":function(){window.open("ShowStatement.php?vid="+a,"_blank")},"Show Registration Form":function(){window.open("ShowRegForm.php?vid="+a,"_blank")},Save:function(){saveFees(b,a,c,!1,"GuestEdit.php?id="+b+"&psg="+memData.idPsg)},Cancel:function(){$(this).dialog("close")}};viewVisit(b,a,d,"Edit Visit #"+a+"-"+c,"",c),$("#divAlert1").hide()}),$("#resvAccordion").accordion({heightStyle:"content",collapsible:!0,active:!1,icons:!1}),$("div.hhk-relations").each(function(){var a=$(this).attr("name");$(this).on("click","td.hhk-deletelink",function(){memData.id>0&&confirm($(this).attr("title")+"?")&&manageRelation(memData.id,$(this).attr("name"),a,"delRel")}),$(this).on("click","td.hhk-newlink",function(){if(memData.id>0){var b=$(this).attr("title");$("#hdnRelCode").val(a),$("#submit").dialog("option","title",b),$("#submit").dialog("open")}})}),$("#cbNoVehicle").change(function(){this.checked?$("#tblVehicle").hide():$("#tblVehicle").show()}),$("#cbNoVehicle").change(),$("#btnNextVeh, #exAll, #exNone").button(),$("#btnNextVeh").click(function(){$("#trVeh"+b).show("fade"),b++,b>4&&$("#btnNextVeh").hide("fade")}),$("#schLogText").keyup(function(){this.value.length>2&&c&&c.fnFilter(this.value,5)}),$("#divNametabs").tabs({beforeActivate:function(a,b){var c=$("#vvisitLog").find("table");3==b.newTab.index()&&0==c.length&&$.post("ws_ckin.php",{cmd:"gtvlog",idReg:memData.idReg},function(a){if(a){try{a=$.parseJSON(a)}catch(a){return void alert("Parser error - "+a.message)}a.error?(a.gotopage&&window.open(a.gotopage,"_self"),flagAlertMessage(a.error,!0)):a.vlog&&$("#vvisitLog").append($(a.vlog))}})},collapsible:!0}),$("#btnSubmit, #btnReset, #btnCred").button(),$("#btnCred").click(function(){cardOnFile($(this).data("id"),$(this).data("idreg"),memData.idPsg)}),$("#phEmlTabs").tabs(),$("#emergTabs").tabs(),$("#addrsTabs").tabs(),$("#psgList").tabs({collapsible:!0,beforeActivate:function(a,b){b.newPanel.length>0&&"#vfin"===b.newPanel.selector&&(getIncomeDiag(0,memData.idReg),a.preventDefault())}}),memData.psgOnly&&$("#psgList").tabs("disable"),$("#psgList").tabs("enable",psgTabIndex),$("#psgList").tabs("option","active",psgTabIndex),$("#cbnoReturn").change(function(){this.checked?$("#selnoReturn").show():$("#selnoReturn").hide()}),$("#cbnoReturn").change(),0===memData.id)$("#divFuncTabs").tabs("option","disabled",[2,3,4]),$("#phEmlTabs").tabs("option","active",1),$("#phEmlTabs").tabs("option","disabled",[0]);else{var d=parseInt($("#addrsTabs").children("ul").data("actidx"),10);isNaN(d)&&(d=0),$("#addrsTabs").tabs("option","active",d)}$.datepicker.setDefaults({yearRange:"-0:+02",changeMonth:!0,changeYear:!0,autoSize:!0,numberOfMonths:1,dateFormat:"M d, yy"}),$(".ckdate").datepicker({yearRange:"-02:+03"}),$(".ckbdate").datepicker({yearRange:"-99:+00",changeMonth:!0,changeYear:!0,autoSize:!0,maxDate:0,dateFormat:"M d, yy"}),$("#cbLastConfirmed").change(function(){$(this).prop("checked")?$("#txtLastConfirmed").datepicker("setDate","+0"):$("#txtLastConfirmed").val($("#txtLastConfirmed").prop("defaultValue"))}),$("#txtLastConfirmed").change(function(){$("#txtLastConfirmed").val()==$("#txtLastConfirmed").prop("defaultValue")?$("#cbLastConfirmed").prop("checked",!1):$("#cbLastConfirmed").prop("checked",!0)}),verifyAddrs("div#nameTab, div#hospitalSection"),addrPrefs(memData);var e;createZipAutoComplete($("input.hhk-zipsearch"),"ws_admin.php",e),$("#btnSubmit").click(function(){return"Saving>>>>"!=$(this).val()&&(a=!0,void $(this).val("Saving>>>>"))}),$("#txtsearch").keypress(function(a){var b=$(this).val();"13"==a.keyCode&&(""!=b&&isNumber(parseInt(b,10))?window.location.assign("GuestEdit.php?id="+b):(alert("Don't press the return key unless you enter an Id."),a.preventDefault()))}),$("#cbdeceased").change(function(){$(this).prop("checked")?$("#disp_deceased").show():$("#disp_deceased").hide()}),$("select.hhk-multisel").each(function(){$(this).multiselect({selectedList:3})});var f;createAutoComplete($("#txtAgentSch"),3,{cmd:"filter",add:"phone",basis:"ra"},getAgent,f),""===$("#a_txtLastName").val()&&$(".hhk-agentInfo").hide(),createAutoComplete($("#txtDocSch"),3,{cmd:"filter",basis:"doc"},getDoc,f),""===$("#d_txtLastName").val()&&$(".hhk-docInfo").hide();var g,h;$("#txtsearch").autocomplete({source:function(a,b){if(isNumber(parseInt(a.term,10)))return void b();if(a.term.search(" ")==a.term.length-1||a.term.search(",")==a.term.length-1)b(h);else{var c={cmd:"role",mode:"mo",letters:a.term};g=$.getJSON("roleSearch.php",c,function(a,c,d){d===g&&(a.error&&(a.gotopage&&window.open(a.gotopage,"_self"),a.value=a.error),b(a),h=a)})}},minLength:3,select:function(a,b){if(b.item){var c=b.item.id;0!==c&&window.location.assign("GuestEdit.php?id="+c)}}}),$("#txtPhsearch").autocomplete({source:function(a,b){var c={cmd:"role",mode:"mo",letters:a.term};g=$.getJSON("roleSearch.php",c,function(a,c,d){d===g&&(a.error&&(a.gotopage&&window.open(a.gotopage,"_self"),a.value=a.error),b(a))})},minLength:5,select:function(a,b){if(b.item){var c=b.item.id;0!==c&&window.location.assign("GuestEdit.php?id="+c)}}}),$("#txtRelSch").autocomplete({source:function(a,b){if(a.term.search(" ")==a.term.length-1||a.term.search(",")==a.term.length-1)b(h);else{var c={cmd:"srrel",letters:a.term,basis:$("#hdnRelCode").val(),id:memData.id,nonly:"1"};g=$.getJSON("roleSearch.php",c,function(a,c,d){d===g?(a.error&&(a.gotopage&&window.open(a.gotopage,"_self"),a.value=a.error),b(a),h=a):b()})}},minLength:3,select:function(a,b){if(b.item){$("#submit").dialog("close");var c=parseInt(b.item.id,10);isNumber(c)&&$.post("ws_admin.php",{rId:c,id:memData.id,rc:$("#hdnRelCode").val(),cmd:"newRel"},relationReturn)}}}),$("input.hhk-check-button").click(function(){"exAll"==$(this).prop("id")?$("input.hhk-ex").prop("checked",!0):$("input.hhk-ex").prop("checked",!1)}),$(".hhk-hideStatus, .hhk-hideBasis").hide(),$("#divFuncTabs").show(),$(".hhk-showonload").show(),$("#txtsearch").focus()});
